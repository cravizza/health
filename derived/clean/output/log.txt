Logging: health\derived\clean\code



-- Executing: health\derived\clean\code/hiv.py
-- Timestamp: 2019-08-30 11:52:59

-- Beneficiaries, time elapsed load and concat: 55 sec.

-- Construct subsample: balanced 2012-2017, ages 18-50 on 31Dec2017
-- Keep if balanced: 66451276 rows dropped (46.75%)
-- Construct subsample: balanced 2015-2017, ages 18-50 on 31Dec2017
-- Keep if balanced: 19906958 rows dropped (30.12%)
-- Subsample beneficiaries, time elapsed: 379 sec.
count    1.754482e+08
mean     7.681073e+05
std      6.688890e+05
min      0.000000e+00
25%      1.063690e+05
50%      6.667040e+05
75%      1.336757e+06
max      1.522648e+09
Name: ti, dtype: float64
count    1.754482e+08
mean     8.625230e+04
std      2.737011e+05
min     -8.693200e+04
25%      3.691800e+04
50%      7.432400e+04
75%      1.204810e+05
max      9.593604e+08
Name: paytot, dtype: float64
salaried     141116324
indep_vol     22318384
other         12013475
Name: e_typ, dtype: int64
indiv      95474687
indcom     18198896
group      14061983
no_info         366
Name: planingr, dtype: int64

-- Income and contracts, time elapsed load and concat: 61 sec.

-- Pbon, time elapsed load and concat: 631 sec.

-- Create HIV subample of pbon
-- Drop if pregnant: 40395139 rows dropped (13.32%)
-- Subsample pbon, time elapsed: 171 sec.

-- Create dataset for aggregate analysis
-- Families
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 442432 entries, 0 to 442431
Data columns (total 14 columns):
month     442432 non-null int32
id_m      442432 non-null int32
isapre    442432 non-null int8
id_b      442432 non-null int32
dob       442432 non-null int32
dod_m     442432 non-null int32
gender    442432 non-null category
civs_m    442432 non-null category
pais_m    442432 non-null category
munici    442432 non-null object
region    442432 non-null object
codrel    442432 non-null category
typben    442432 non-null category
hiv       442432 non-null int8
dtypes: category(5), int32(5), int8(2), object(2)
memory usage: 48.6 MB
-- Pbon
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 3003717 entries, 0 to 3003716
Data columns (total 17 columns):
month     int32
id_m      int32
id_b      int32
isapre    int8
typreg    category
gender    category
age       int8
typben    category
code      object
codeid    category
date      int32
copay     int32
planty    category
proreg    category
promun    category
code2     category
code7     object
dtypes: category(8), int32(5), int8(2), object(2)
memory usage: 363.8 MB
-- HIV aggregate, time elapsed: 222 sec.

-- Create dataset for individual analysis
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 19663 entries, 0 to 19662
Data columns (total 3 columns):
id_m     19663 non-null int32
id_b     19663 non-null int32
month    19663 non-null int32
dtypes: int32(3)
memory usage: 230.5 KB
-- Families
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 41012 entries, 0 to 41011
Data columns (total 16 columns):
month      41012 non-null int32
id_m       41012 non-null int32
isapre     41012 non-null int8
id_b       41012 non-null int32
dob        41012 non-null int32
dod_m      41012 non-null int32
gender     41012 non-null category
civs_m     41012 non-null category
pais_m     41012 non-null category
munici     41012 non-null object
region     41012 non-null object
codrel     41012 non-null category
typben     41012 non-null category
hiv        41012 non-null int8
control    19429 non-null object
mD         19429 non-null float64
dtypes: category(5), float64(1), int32(5), int8(2), object(3)
memory usage: 6.1 MB
-- Pbon
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1432707 entries, 0 to 1432706
Data columns (total 19 columns):
id_m       1432707 non-null int32
id_b       1432707 non-null int32
control    1432707 non-null bool
mD         1432707 non-null int32
isapre     1432707 non-null int8
month      1432707 non-null int32
typreg     1432707 non-null category
gender     1432707 non-null category
age        1432707 non-null int8
typben     1432707 non-null category
code       1432707 non-null object
codeid     1432707 non-null category
date       1432707 non-null int32
copay      1432707 non-null int32
planty     1432707 non-null category
proreg     1432707 non-null category
promun     1432707 non-null category
code2      1432707 non-null object
code7      1432707 non-null object
dtypes: bool(1), category(7), int32(6), int8(2), object(3)
memory usage: 237.8 MB

-- HIV individual, time elapsed: 169 sec.

-- Timestamp: 2019-08-30 12:21:09




-- Executing: health\derived\clean\code/seasonality.py
-- Timestamp: 2019-08-30 11:49:09

-- Time elapsed load and concat: 94 sec.


-- Timestamp: 2019-08-30 11:52:57
