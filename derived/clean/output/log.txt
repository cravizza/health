Logging: health\derived\clean\code



-- Executing: health\derived\clean\code/hiv.py
-- Timestamp: 2019-08-25 23:14:13

-- Beneficiaries, time elapsed load and concat: 59 sec.

-- Construct subsample: balanced 2012-2017, ages 18-50 on 31Dec2017
-- Keep if balanced: 66451276 rows dropped (46.75%)
-- Construct subsample: balanced 2015-2017, ages 18-50 on 31Dec2017
-- Keep if balanced: 19906958 rows dropped (30.12%)
-- Subsample beneficiaries, time elapsed: 441 sec.
count    1.754482e+08
mean     7.681073e+05
std      6.688890e+05
min      0.000000e+00
25%      1.063690e+05
50%      6.667040e+05
75%      1.336757e+06
max      1.522648e+09
Name: ti, dtype: float64
count    1.754482e+08
mean     8.625230e+04
std      2.737011e+05
min     -8.693200e+04
25%      3.691800e+04
50%      7.432400e+04
75%      1.204810e+05
max      9.593604e+08
Name: paytot, dtype: float64
salaried     141116324
indep_vol     22318384
other         12013475
Name: e_typ, dtype: int64
indiv      95474687
indcom     18198896
group      14061983
no_info         366
Name: planingr, dtype: int64

-- Income and contracts, time elapsed load and concat: 66 sec.

-- Pbon, time elapsed load and concat: 817 sec.

-- Create HIV subample of pbon
-- Drop if pregnant: 36958649 rows dropped (12.19%)
-- Subsample pbon, time elapsed: 202 sec.

-- Create dataset for aggregate analysis
-- Families
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 454722 entries, 0 to 454721
Data columns (total 14 columns):
month     454722 non-null int32
id_m      454722 non-null int32
isapre    454722 non-null int8
id_b      454722 non-null int32
dob       454722 non-null int32
dod_m     454722 non-null int32
gender    454722 non-null category
civs_m    454722 non-null category
pais_m    454722 non-null category
munici    454722 non-null object
region    454722 non-null object
codrel    454722 non-null category
typben    454722 non-null category
hiv       454722 non-null int8
dtypes: category(5), int32(5), int8(2), object(2)
memory usage: 50.0 MB
-- Pbon
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 3103731 entries, 0 to 3103730
Data columns (total 17 columns):
month     int32
id_m      int32
id_b      int32
isapre    int8
typreg    category
gender    category
age       int8
typben    category
code      object
codeid    category
date      int32
copay     int32
planty    category
proreg    category
promun    category
code2     category
code7     object
dtypes: category(8), int32(5), int8(2), object(2)
memory usage: 375.9 MB
-- HIV aggregate, time elapsed: 283 sec.

-- Create dataset for individual analysis
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 21408 entries, 0 to 21407
Data columns (total 3 columns):
id_m     21408 non-null int32
id_b     21408 non-null int32
month    21408 non-null int32
dtypes: int32(3)
memory usage: 250.9 KB
-- Families
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 43920 entries, 0 to 43919
Data columns (total 16 columns):
month      43920 non-null int32
id_m       43920 non-null int32
isapre     43920 non-null int8
id_b       43920 non-null int32
dob        43920 non-null int32
dod_m      43920 non-null int32
gender     43920 non-null category
civs_m     43920 non-null category
pais_m     43920 non-null category
munici     43920 non-null object
region     43920 non-null object
codrel     43920 non-null category
typben     43920 non-null category
hiv        43920 non-null int8
control    21157 non-null object
mD         21157 non-null float64
dtypes: category(5), float64(1), int32(5), int8(2), object(3)
memory usage: 6.5 MB
-- Pbon
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1603160 entries, 0 to 1603159
Data columns (total 19 columns):
id_m       1603160 non-null int32
id_b       1603160 non-null int32
control    1603160 non-null bool
mD         1603160 non-null int32
isapre     1603160 non-null int8
month      1603160 non-null int32
typreg     1603160 non-null category
gender     1603160 non-null category
age        1603160 non-null int8
typben     1603160 non-null category
code       1603160 non-null object
codeid     1603160 non-null category
date       1603160 non-null int32
copay      1603160 non-null int32
planty     1603160 non-null category
proreg     1603160 non-null category
promun     1603160 non-null category
code2      1603160 non-null object
code7      1603160 non-null object
dtypes: bool(1), category(7), int32(6), int8(2), object(3)
memory usage: 266.0 MB

-- HIV individual, time elapsed: 205 sec.

-- Timestamp: 2019-08-25 23:48:49




-- Executing: health\derived\clean\code/seasonality.py
-- Timestamp: 2019-08-25 23:10:51

-- Time elapsed load and concat: 40 sec.


-- Timestamp: 2019-08-25 23:14:10
