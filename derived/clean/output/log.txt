Logging: health\derived\clean\code



-- Executing: health\derived\clean\code/hiv.py
-- Timestamp: 2019-09-11 13:09:46

-- Beneficiaries, time elapsed load and concat: 26 sec.

-- Construct subsample: balanced 2012-2017, ages 18-50 on 31Dec2017
-- Keep if balanced: 66451276 rows dropped (46.75%)
-- Construct subsample: balanced 2015-2017, ages 18-50 on 31Dec2017
-- Keep if balanced: 19906958 rows dropped (30.12%)
-- Subsample beneficiaries, time elapsed: 545 sec.
count    1.243634e+08
mean     1.036963e+06
std      6.727787e+05
min      0.000000e+00
25%      5.319420e+05
50%      9.953960e+05
75%      1.587074e+06
max      1.522648e+09
Name: ti, dtype: float64
count    1.243634e+08
mean     1.090306e+05
std      8.168435e+04
min      0.000000e+00
25%      6.076900e+04
50%      9.786700e+04
75%      1.356200e+05
max      3.536526e+08
Name: paytot, dtype: float64
salaried     141116324
indep_vol     22318384
other         12013475
Name: e_typ, dtype: int64
indiv      95474687
indcom     18198896
group      14061983
no_info         366
Name: planingr, dtype: int64

-- Income and contracts, time elapsed load and concat: 38 sec.

-- Pbon, time elapsed load and concat: 1150 sec.

-- Create HIV subsample of pbon
-- Drop if pregnant: 40395139 rows dropped (13.32%)
-- Subsample pbon, time elapsed: 246 sec.

-- Create dataset for aggregate analysis
-- Families
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 424988 entries, 0 to 424987
Data columns (total 18 columns):
month       424988 non-null int32
id_m        424988 non-null int32
indcom      424988 non-null int8
salaried    424988 non-null int8
ti          424988 non-null int32
paytot      424988 non-null int32
isapre      424988 non-null int8
id_b        424988 non-null int32
dob         424988 non-null int32
dod_m       424988 non-null int32
gender      424988 non-null category
civs_m      424988 non-null category
pais_m      424988 non-null category
munici      424988 non-null object
region      424988 non-null object
codrel      424988 non-null category
typben      424988 non-null category
hiv         424988 non-null int8
dtypes: category(5), int32(7), int8(4), object(2)
memory usage: 50.8 MB
-- Pbon
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 3003717 entries, 0 to 3003716
Data columns (total 17 columns):
month     int32
id_m      int32
id_b      int32
isapre    int8
typreg    category
gender    category
age       int8
typben    category
code      object
codeid    category
date      int32
copay     int32
planty    category
proreg    category
promun    category
code2     category
code7     object
dtypes: category(8), int32(5), int8(2), object(2)
memory usage: 363.8 MB
-- HIV aggregate, time elapsed: 679 sec.

-- Create dataset for individual analysis: balanced sample of testers
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 19663 entries, 0 to 19662
Data columns (total 3 columns):
id_m     19663 non-null int32
id_b     19663 non-null int32
month    19663 non-null int32
dtypes: int32(3)
memory usage: 230.5 KB
-- Families
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 40160 entries, 0 to 40159
Data columns (total 20 columns):
month       40160 non-null int32
id_m        40160 non-null int32
indcom      40160 non-null int8
salaried    40160 non-null int8
ti          40160 non-null int32
paytot      40160 non-null int32
isapre      40160 non-null int8
id_b        40160 non-null int32
dob         40160 non-null int32
dod_m       40160 non-null int32
gender      40160 non-null category
civs_m      40160 non-null category
pais_m      40160 non-null category
munici      40160 non-null object
region      40160 non-null object
codrel      40160 non-null category
typben      40160 non-null category
hiv         40160 non-null int8
control     18989 non-null object
mD          18989 non-null float64
dtypes: category(5), float64(1), int32(7), int8(4), object(3)
memory usage: 6.3 MB
-- Pbon
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1432707 entries, 0 to 1432706
Data columns (total 19 columns):
id_m       1432707 non-null int32
id_b       1432707 non-null int32
control    1432707 non-null bool
mD         1432707 non-null int32
isapre     1432707 non-null int8
month      1432707 non-null int32
typreg     1432707 non-null category
gender     1432707 non-null category
age        1432707 non-null int8
typben     1432707 non-null category
code       1432707 non-null object
codeid     1432707 non-null category
date       1432707 non-null int32
copay      1432707 non-null int32
planty     1432707 non-null category
proreg     1432707 non-null category
promun     1432707 non-null category
code2      1432707 non-null object
code7      1432707 non-null object
dtypes: bool(1), category(7), int32(6), int8(2), object(3)
memory usage: 237.8 MB

-- HIV individual, time elapsed: 493 sec.

-- Timestamp: 2019-09-11 14:02:46




-- Executing: health\derived\clean\code/seasonality.py
-- Timestamp: 2019-08-30 11:49:09

-- Time elapsed load and concat: 94 sec.


-- Timestamp: 2019-08-30 11:52:57
