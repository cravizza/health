Logging: health\derived\append\code



-- Executing: health\derived\append\code/beneficiaries.py
-- Timestamp: 2019-04-19 18:50:33

-- Begin pool 
-- Time pool.map and concat:  1864 sec.

-- Concat dataframe dtypes
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 240052718 entries, 0 to 240052717
Data columns (total 16 columns):
month       Int32
isapre      Int8
id_m        Int32
id_m_alt    Int32
id_b        Int32
id_b_alt    Int32
dob         Int32
dod_m       Int32
gender      category
civs_m      category
pais_m      category
munici      Int32
region      Int8
codrel      category
typben      category
valid       category
dtypes: Int32(8), Int8(2), category(6)
memory usage: 11.2 GB

-- Cleaning 
-- Keep if valid=s    :  4977157 rows dropped (2.07%)
-- Drop if id_alt!=0  :  3316274 rows dropped (1.38%)
-- Drop if rut zero   :  2867918 rows dropped (1.19%)
-- Drop if dupl. keys :  1160250 rows dropped (0.48%)
-- Total rows dropped : 12321599 rows dropped (5.13%)
-- Time elapsed cleaning : 1061 sec.

-- Descriptive stats

masculino    123743574
femenino     103975230
no info          12315
Name: gender, dtype: int64

no info       145974330
casada         44768123
soltera        35524187
divorciada       951529
viuda            512950
Name: civs_m, dtype: int64

no info       160687304
chilena        67041249
extranjera         2566
Name: pais_m, dtype: int64

cotizante    125661911
hijo          77051520
conyuge       17620825
no info        6536176
parent          860687
Name: codrel, dtype: int64

cotizante       125644706
carga           101874786
beneficiario       182604
no info             29023
Name: typben, dtype: int64

-- Final dataframe dtypes
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 227731119 entries, 0 to 227731118
Data columns (total 13 columns):
month     category
isapre    category
id_m      Int32
id_b      Int32
dob       Int32
dod_m     Int32
gender    category
civs_m    category
pais_m    category
munici    category
region    category
codrel    category
typben    category
dtypes: Int32(4), category(9)
memory usage: 6.4 GB

-- Create dictionary of families

-- Split dataframe 
-- Slices equal to concat dataframe: True

-- Begin pickling 
-- Time elapsed first half:  26 sec.
-- Time elapsed second half: 25 sec.

-- Total time elapsed: 57 min. / 3431 sec.

-- Timestamp: 2019-04-19 19:47:45




-- Executing: health\derived\append\code/dictionaries.py
-- Timestamp: 2019-04-19 19:48:15

-- Begin MONTH dictionary

-- Begin pool PROMUN CODE PROID
-- Time pool.map and concat:  1504 sec.

-- Create PROMUN dictionary

-- Create CODE dictionary

-- Create PROID dictionary

-- Total time elapsed: 26 min. | 1609 sec.

-- Timestamp: 2019-04-19 20:15:05




-- Executing: health\derived\append\code/pbonificadas.py
-- Timestamp: 2019-04-19 20:15:27

-- Begin pool 
-- Time pool.map and concat:  1785 sec.

-- Concat dataframe dtypes
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 343959558 entries, 0 to 343959557
Data columns (total 16 columns):
isapre    int8
month     category
typreg    category
id_b      int32
gender    category
age       int8
typben    category
proid     category
code      category
codeid    category
date      category
copay     int32
planty    category
proreg    category
promun    category
id_m      int32
dtypes: category(11), int32(3), int8(2)
memory usage: 9.9 GB

-- Concat dataframe size
Index             72
isapre     343959558
month      343965502
typreg     343959906
id_b      1375838232
gender     343959784
age        343959558
typben     343959734
proid     1386064563
code       688788041
codeid     343959789
date       688112828
copay     1375838232
planty     343959782
proreg     343960876
promun     687963841
id_m      1375838232
dtype: int64

-- Cleaning 
-- Drop if not in beneficiaries:  15759535 rows dropped (4.58%)
-- Time elapsed cleaning : 306 sec.

-- Descriptive stats 

femenino     187993592
masculino    140206340
unborn              90
NaN                  1
Name: gender, dtype: int64

cotizante    199341847
carga        128858176
Name: typben, dtype: int64

curativa    324966657
emp           2996421
child          178882
pregnant        58063
Name: typreg, dtype: int64

general    224674643
reduced    103453163
no info        72217
Name: planty, dtype: int64

fonasa              283563579
superintendencia     34370877
isapre               10265123
NaN                       444
Name: codeid, dtype: int64

-- Final dataframe dtypes
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 328200023 entries, 0 to 328200022
Data columns (total 16 columns):
isapre    category
month     category
typreg    category
id_b      int32
gender    category
age       int8
typben    category
proid     category
code      category
codeid    category
date      category
copay     int32
planty    category
proreg    category
promun    category
id_m      int32
dtypes: category(12), int32(3), int8(1)
memory usage: 9.5 GB

-- Split final dataframe 

-- Begin pickling 
-- Time elapsed first third:  29 sec.
-- Time elapsed second third: 27 sec.
-- Time elapsed second third: 27 sec.

-- Total time elapsed: 36 min. | 2202 sec.

-- Timestamp: 2019-04-19 20:52:11
